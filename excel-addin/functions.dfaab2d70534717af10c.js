/*! office-add-in-shared-runtime-ribbon v.1.0.0 (1600995973404) Â©  */!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/excel-addin",n(n.s="./functions/functions.ts")}({"../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"../utilities/office-apis-helpers.ts":function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.monitorSheetChanges=t.ensureStateInitialized=t.generateCustomFunction=t.connectService=t.updateRibbon=t.SetStartupBehaviorHelper=t.SetRuntimeVisibleHelper=void 0;var r=n("./commands/commands.ts");function i(){var e=r.getGlobal();OfficeRuntime.ui.getRibbon().then((function(t){t.requestUpdate({tabs:[{id:"ShareTime",controls:[{id:"BtnConnectService",enabled:!e.state.isConnected},{id:"BtnDisConnectService",enabled:e.state.isConnected},{id:"BtnInsertData",enabled:e.state.isConnected},{id:"BtnSumData",enabled:e.state.isSumEnabled},{id:"BtnEnableAddinStart",enabled:!e.state.isStartOnDocOpen},{id:"BtnDisableAddinStart",enabled:e.state.isStartOnDocOpen},{id:"BtnOpenTaskpane",enabled:!e.state.isTaskpaneOpen},{id:"BtnCloseTaskpane",enabled:e.state.isTaskpaneOpen}]}]})}))}t.SetRuntimeVisibleHelper=function(e){return(e?Office.addin.showAsTaskpane():Office.addin.hide()).then((function(){return e})).catch((function(e){return e.code}))},t.SetStartupBehaviorHelper=function(e){e?Office.addin.setStartupBehavior(Office.StartupBehavior.load):Office.addin.setStartupBehavior(Office.StartupBehavior.none),r.getGlobal().isStartOnDocOpen=e},t.updateRibbon=i;var s=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/login/connect.html";function c(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){return t=r.getGlobal(),[2,Excel.run((function(n){return n.sync().then((function(){console.log("Table section changed..."),console.log("Change type of event: "+e.changeType),console.log("Address of event: "+e.address),console.log("Source of event: "+e.source),t.state.selectionAddress=e.address,""===e.address&&!0===t.state.isSumEnabled?(t.state.isSumEnabled=!1,i()):!1===t.state.isSumEnabled&&""!==e.address&&(t.state.isSumEnabled=!0,i())}))}))]}))}))}t.connectService=function(){return o(this,void 0,void 0,(function(){var e,t,n;return a(this,(function(o){switch(o.label){case 0:return t=function(){var t=r.getGlobal();t.state.setConnected(!0),t.state.isConnectInProgress=!1,e.close()},n=r.getGlobal(),[4,Office.context.ui.displayDialogAsync(s,{height:40,width:30,promptBeforeOpen:!1},(function(o){o.status===Office.AsyncResultStatus.Failed?(console.log(o.error.code+" "+o.error.message),n.state.setConnected(!1)):(e=o.value).addEventHandler(Office.EventType.DialogMessageReceived,t)}))];case 1:return o.sent(),[2]}}))}))},t.generateCustomFunction=function(e){var t=this;try{Excel.run((function(n){return o(t,void 0,void 0,(function(){var t;return a(this,(function(o){return(t=n.workbook.getSelectedRange()).values=[['=CONTOSOSHARE.GETDATA("'+e+'")']],t.format.autofitColumns(),[2,n.sync()]}))}))}))}catch(e){console.error(e)}},t.ensureStateInitialized=function(e){return o(this,void 0,void 0,(function(){var t,n,o;return a(this,(function(a){switch(a.label){case 0:return console.log("ensureInitialize called"),t=r.getGlobal(),n=!1,e&&(void 0!==t.state&&!1===t.state.isInitialized&&(t.state.isInitialized=!0),void 0===t.state&&(n=!0)),void 0!==t.state?[3,2]:(t.state={isStartOnDocOpen:!1,isSignedIn:!1,isTaskpaneOpen:!1,isConnected:!1,isSyncEnabled:!1,isConnectInProgress:!1,isFirstSyncCall:!0,isSumEnabled:!1,isInitialized:n,updateRct:function(){},setTaskpaneStatus:function(e){t.state.isTaskpaneOpen=e,i()},setConnected:function(e){t.state.isConnected=e,e?null!==t.state.updateRct&&t.state.updateRct("true"):null!==t.state.updateRct&&t.state.updateRct("false"),i()}},[4,Office.addin.getStartupBehavior()]);case 1:o=a.sent(),console.log("load state is:"),console.log("load state"+o),o===Office.StartupBehavior.load&&(t.state.isStartOnDocOpen=!0),"yes"===localStorage.getItem("loggedIn")&&(t.state.isSignedIn=!0),a.label=2;case 2:return i(),[2]}}))}))},t.monitorSheetChanges=function(){return o(this,void 0,void 0,(function(){var e,t,n=this;return a(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),void 0===(e=r.getGlobal()).state?[2]:e.state.isInitialized?[4,Excel.run((function(t){return o(n,void 0,void 0,(function(){var n;return a(this,(function(o){switch(o.label){case 0:return void 0===(n=t.workbook.tables.getItem("ExpensesTable"))?[3,2]:(n.onSelectionChanged.add(c),[4,t.sync()]);case 1:return o.sent(),i(),[3,3];case 2:e.state.isSumEnabled=!1,i(),o.label=3;case 3:return[2]}}))}))}))]:[3,2];case 1:s.sent(),s.label=2;case 2:return[3,4];case 3:return t=s.sent(),console.error(t),[3,4];case 4:return[2]}}))}))}},"./commands/commands.ts":function(e,t,n){"use strict";(function(e){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function i(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.btnSumData=t.btnInsertData=t.btnDisableAddinStart=t.btnEnableAddinStart=t.btnCloseTaskpane=t.btnOpenTaskpane=t.btnDisconnectService=t.btnConnectService=t.getGlobal=void 0;var r=n("../utilities/office-apis-helpers.ts");function i(){return console.log("init globals for command buttons"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0}t.getGlobal=i;var s=i();function c(e){console.log("Connect service button pressed"),s.state.setConnected(!0),s.state.isConnectInProgress=!0,r.updateRibbon(),r.connectService(),r.monitorSheetChanges(),e.completed()}function u(e){console.log("Disconnect service button pressed"),s.state.setConnected(!1),r.updateRibbon(),e.completed()}function l(e){console.log("Open task pane button pressed"),r.SetRuntimeVisibleHelper(!0),s.state.isTaskpaneOpen=!0,r.updateRibbon(),e.completed()}function d(e){console.log("Open task pane button pressed"),r.SetRuntimeVisibleHelper(!1),s.state.isTaskpaneOpen=!1,r.updateRibbon(),e.completed()}function f(e){console.log("Enable add-in start button pressed"),r.SetStartupBehaviorHelper(!0),s.state.isStartOnDocOpen=!0,r.updateRibbon(),e.completed()}function p(e){console.log("Disable add-in start button pressed"),r.SetStartupBehaviorHelper(!1),s.state.isStartOnDocOpen=!1,r.updateRibbon(),e.completed()}function b(e){console.log("Insert data button pressed"),function(){o(this,void 0,void 0,(function(){var e,t=this;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Excel.run((function(e){return o(t,void 0,void 0,(function(){var t,n;return a(this,(function(o){return t=e.workbook.worksheets.getActiveWorksheet(),(n=t.tables.add("A1:D1",!0)).name="ExpensesTable",n.getHeaderRowRange().values=[["Date","Merchant","Category","Amount"]],n.rows.add(null,[["1/1/2017","The Phone Company","Communications","$120"],["1/2/2017","Northwind Electric Cars","Transportation","$142"],["1/5/2017","Best For You Organics Company","Groceries","$27"],["1/10/2017","Coho Vineyard","Restaurant","$33"],["1/11/2017","Bellows College","Education","$350"],["1/15/2017","Trey Research","Other","$135"],["1/15/2017","Best For You Organics Company","Groceries","$97"]]),Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(t.getUsedRange().format.autofitColumns(),t.getUsedRange().format.autofitRows()),e.sync().then((function(){return r.monitorSheetChanges(),e.sync()})),[2]}))}))}))];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.log(e),[3,3];case 3:return[2]}}))}))}(),e.completed()}function h(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return console.log("Insert data button pressed"),t=s.state.selectionAddress,[4,Excel.run((function(n){var o=n.workbook.worksheets.getActiveWorksheet().getRange(t);o.load("values");var a=0;return n.sync().then((function(){return o.values.forEach((function(e){var t=+e.toString();a+=t})),n.sync().then((function(){var t=n.workbook.worksheets.getActiveWorksheet().getRange("F1");return t.values=[[a]],t.format.autofitColumns(),e.completed(),console.log(a),n.sync()}))}))}))];case 1:return n.sent(),e.completed(),[2]}}))}))}s.btnenableaddinstart=f,s.btndisableaddinstart=p,s.btninsertdata=b,s.btnopentaskpane=l,s.btnclosetaskpane=d,s.btnconnectservice=c,s.btndisconnectservice=u,s.btnsumdata=h,t.btnConnectService=c,t.btnDisconnectService=u,t.btnOpenTaskpane=l,t.btnCloseTaskpane=d,t.btnEnableAddinStart=f,t.btnDisableAddinStart=p,t.btnInsertData=b,t.btnSumData=h}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./functions/functions.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.add=void 0;var o=n("./commands/commands.ts");function a(e,t){return e+t}function r(e){if(o.getGlobal().state.isConnected)return"Communications"===e?[["1/1/2017","The Phone Company","Communications","$120"]]:"Transportation"===e?[["1/2/2017","Northwind Electric Cars","Transportation","$142"]]:"Groceries"===e?[["1/5/2017","Best For You Organics Company","Groceries","$27"],["1/15/2017","Best For You Organics Company","Groceries","$97"]]:[["1/1/2017","The Phone Company","Communications","$120"],["1/2/2017","Northwind Electric Cars","Transportation","$142"],["1/5/2017","Best For You Organics Company","Groceries","$27"],["1/10/2017","Coho Vineyard","Restaurant","$33"],["1/11/2017","Bellows College","Education","$350"],["1/15/2017","Trey Research","Other","$135"],["1/15/2017","Best For You Organics Company","Groceries","$97"]];throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable)}t.add=a,t.getData=r,CustomFunctions.associate("ADD",a),CustomFunctions.associate("GETDATA",r),CustomFunctions.associate("ADD",a),CustomFunctions.associate("GETDATA",r)}});