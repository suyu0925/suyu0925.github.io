{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../node_modules/webpack/buildin/global.js","webpack:///../utilities/office-apis-helpers.ts","webpack:///./commands/commands.ts","webpack:///./functions/functions.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","g","this","Function","e","window","updateRibbon","getGlobal","OfficeRuntime","ui","getRibbon","then","ribbon","requestUpdate","tabs","id","controls","enabled","state","isConnected","isSumEnabled","isStartOnDocOpen","isTaskpaneOpen","SetRuntimeVisibleHelper","visible","Office","addin","showAsTaskpane","hide","catch","error","code","SetStartupBehaviorHelper","isStarting","setStartupBehavior","StartupBehavior","load","none","dialogConnectUrl","location","protocol","hostname","port","onTableSelectionChange","event","Excel","run","context","sync","console","log","changeType","address","source","selectionAddress","processMessage","setConnected","isConnectInProgress","connectDialog","close","displayDialogAsync","height","width","promptBeforeOpen","result","status","AsyncResultStatus","Failed","message","addEventHandler","EventType","DialogMessageReceived","selectedOption","range","workbook","getSelectedRange","values","format","autofitColumns","isOfficeInitializing","initValue","undefined","isInitialized","isSignedIn","isSyncEnabled","isFirstSyncCall","updateRct","setTaskpaneStatus","opened","connected","getStartupBehavior","addinState","localStorage","getItem","table","tables","onSelectionChanged","add","self","global","btnConnectService","connectService","monitorSheetChanges","completed","btnDisconnectService","btnOpenTaskpane","btnCloseTaskpane","btnEnableAddinStart","btnDisableAddinStart","btnInsertData","sheet","worksheets","getActiveWorksheet","expensesTable","getHeaderRowRange","rows","requirements","isSetSupported","getUsedRange","autofitRows","insertData","btnSumData","getRange","sum","forEach","v","vnumber","toString","btnenableaddinstart","btndisableaddinstart","btninsertdata","btnopentaskpane","btnclosetaskpane","btnconnectservice","btndisconnectservice","btnsumdata","first","second","getData","category","CustomFunctions","Error","ErrorCode","notAvailable"],"mappings":"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","file":"functions.a552a837b808681a6180.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./functions/functions.ts\");\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import { getGlobal } from '../src/commands/commands';\n\nexport const SetRuntimeVisibleHelper = (visible: boolean) => {\n  let p: any;\n  if (visible) {\n    p = Office.addin.showAsTaskpane();\n  } else {\n    p = Office.addin.hide();\n  }\n\n  return p\n    .then(() => {\n      return visible;\n    })\n    .catch(error => {\n      return error.code;\n    });\n};\n\nexport const SetStartupBehaviorHelper = (isStarting: boolean) => {\n  if (isStarting) {\n    Office.addin.setStartupBehavior(Office.StartupBehavior.load);\n  } else {\n    Office.addin.setStartupBehavior(Office.StartupBehavior.none);\n  }\n  let g = getGlobal() as any;\n  g.isStartOnDocOpen = isStarting;\n};\n\nexport function updateRibbon() {\n  // Update ribbon based on state tracking\n  const g = getGlobal() as any;\n\n  // @ts-ignore\n  OfficeRuntime.ui\n    .getRibbon()\n    // @ts-ignore\n    .then(ribbon => {\n      ribbon.requestUpdate({\n        tabs: [\n          {\n            id: 'ShareTime',\n            controls: [\n              {\n                id: 'BtnConnectService',\n                enabled: !g.state.isConnected\n              },\n              {\n                id: 'BtnDisConnectService',\n                enabled: g.state.isConnected\n              },\n              {\n                id: 'BtnInsertData',\n                enabled: g.state.isConnected\n              },\n              {\n                id: 'BtnSumData',\n                enabled: g.state.isSumEnabled\n              },\n              {\n                id: 'BtnEnableAddinStart',\n                enabled: !g.state.isStartOnDocOpen\n              },\n              {\n                id: 'BtnDisableAddinStart',\n                enabled: g.state.isStartOnDocOpen\n              },\n              {\n                id: 'BtnOpenTaskpane',\n                enabled: !g.state.isTaskpaneOpen\n              },\n              {\n                id: 'BtnCloseTaskpane',\n                enabled: g.state.isTaskpaneOpen\n              }\n            ]\n          }\n        ]\n      });\n    });\n}\n\n/*\n    Managing the dialogs.\n*/\n\nconst dialogConnectUrl: string =\n  location.protocol +\n  '//' +\n  location.hostname +\n  (location.port ? ':' + location.port : '') +\n  '/login/connect.html';\n\nexport async function connectService() {\n  //pop up a dialog\n  let connectDialog: Office.Dialog;\n\n  const processMessage = () => {\n    const g = getGlobal() as any;\n    g.state.setConnected(true);\n    g.state.isConnectInProgress = false;\n    connectDialog.close();\n  };\n\n  let g = getGlobal() as any;\n  await Office.context.ui.displayDialogAsync(\n    dialogConnectUrl,\n    { height: 40, width: 30, promptBeforeOpen: false },\n    result => {\n      if (result.status === Office.AsyncResultStatus.Failed) {\n        console.log(`${result.error.code} ${result.error.message}`);\n        g.state.setConnected(false);\n      } else {\n        connectDialog = result.value;\n        connectDialog.addEventHandler(\n          Office.EventType.DialogMessageReceived,\n          processMessage\n        );\n      }\n    }\n  );\n}\n\nexport function generateCustomFunction(selectedOption: string) {\n  try {\n    Excel.run(async context => {\n      /**\n       * Insert your Excel code here\n       */\n      let range = context.workbook.getSelectedRange();\n\n      //let selectedOption = 'Communications';\n\n      range.values = [['=CONTOSOSHARE.GETDATA(\"' + selectedOption + '\")']];\n      range.format.autofitColumns();\n      return context.sync();\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n//This will check if state is initialized, and if not, initialize it.\n//Useful as there are multiple entry points that need the state and it is not clear which one will get called first.\nexport async function ensureStateInitialized(isOfficeInitializing: boolean) {\n  console.log('ensureInitialize called');\n  let g = getGlobal() as any;\n  let initValue = false;\n  if (isOfficeInitializing) {\n    //we are being called in response to Office Initialize\n    if (g.state !== undefined) {\n      if (g.state.isInitialized === false) {\n        g.state.isInitialized = true;\n      }\n    }\n    if (g.state === undefined) {\n      initValue = true;\n    }\n  }\n\n  if (g.state === undefined) {\n    g.state = {\n      isStartOnDocOpen: false,\n      isSignedIn: false,\n      isTaskpaneOpen: false,\n      isConnected: false,\n      isSyncEnabled: false,\n      isConnectInProgress: false,\n      isFirstSyncCall: true,\n      isSumEnabled: false,\n      isInitialized: initValue,\n      updateRct: () => {},\n      setTaskpaneStatus: (opened: boolean) => {\n        g.state.isTaskpaneOpen = opened;\n        updateRibbon();\n      },\n      setConnected: (connected: boolean) => {\n        g.state.isConnected = connected;\n\n        if (connected) {\n          if (g.state.updateRct !== null) {\n            g.state.updateRct('true');\n          }\n        } else {\n          if (g.state.updateRct !== null) {\n            g.state.updateRct('false');\n          }\n        }\n        updateRibbon();\n      }\n    };\n    // console.log(\"init value:\" + initValue);\n    // console.log(\"is initialized: \" + g.state.isInitialized);\n    // monitorSheetChanges();\n\n    let addinState = await Office.addin.getStartupBehavior();\n    console.log('load state is:');\n    console.log('load state' + addinState);\n    if (addinState === Office.StartupBehavior.load) {\n      g.state.isStartOnDocOpen = true;\n    }\n    if (localStorage.getItem('loggedIn') === 'yes') {\n      g.state.isSignedIn = true;\n    }\n  }\n  updateRibbon();\n}\n\nasync function onTableSelectionChange(event) {\n  let g = getGlobal() as any;\n  return Excel.run(context => {\n    return context.sync().then(() => {\n      console.log('Table section changed...');\n      console.log('Change type of event: ' + event.changeType);\n      console.log('Address of event: ' + event.address);\n      console.log('Source of event: ' + event.source);\n      g.state.selectionAddress = event.address;\n      if (event.address === '' && g.state.isSumEnabled === true) {\n        g.state.isSumEnabled = false;\n        updateRibbon();\n      } else if (g.state.isSumEnabled === false && event.address !== '') {\n        g.state.isSumEnabled = true;\n        updateRibbon();\n      }\n    });\n  });\n}\n\nexport async function monitorSheetChanges() {\n  try {\n    let g = getGlobal() as any;\n    if (g.state === undefined) {\n      return;\n    }\n    if (g.state.isInitialized) {\n      await Excel.run(async context => {\n        let table = context.workbook.tables.getItem('ExpensesTable');\n        if (table !== undefined) {\n          table.onSelectionChanged.add(onTableSelectionChange);\n          await context.sync();\n          updateRibbon();\n        } else {\n          g.state.isSumEnabled = false;\n          updateRibbon();\n        }\n      });\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\n","import {\n  SetStartupBehaviorHelper,\n  SetRuntimeVisibleHelper,\n  updateRibbon,\n  connectService,\n  monitorSheetChanges\n} from '../../utilities/office-apis-helpers';\n\nexport function getGlobal() {\n    console.log('init globals for command buttons');\n    return typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n      ? window\n      : typeof global !== 'undefined'\n      ? global\n      : undefined;\n  }\n\nconst g = getGlobal() as any;\n\n// the add-in command functions need to be available in global scope\ng.btnenableaddinstart = btnEnableAddinStart;\ng.btndisableaddinstart = btnDisableAddinStart;\ng.btninsertdata = btnInsertData;\ng.btnopentaskpane = btnOpenTaskpane;\ng.btnclosetaskpane = btnCloseTaskpane;\ng.btnconnectservice = btnConnectService;\ng.btndisconnectservice = btnDisconnectService;\ng.btnsumdata = btnSumData;\n\nexport function btnConnectService(event: Office.AddinCommands.Event) {\n  console.log('Connect service button pressed');\n  // Your code goes here\n  g.state.setConnected(true);\n  g.state.isConnectInProgress = true;\n  updateRibbon();\n  connectService();\n  monitorSheetChanges();\n  event.completed();\n}\nexport function btnDisconnectService(event: Office.AddinCommands.Event) {\n  console.log('Disconnect service button pressed');\n  // Your code goes here\n  g.state.setConnected(false);\n  updateRibbon();\n  event.completed();\n}\n\nexport function btnOpenTaskpane(event: Office.AddinCommands.Event) {\n  console.log('Open task pane button pressed');\n  // Your code goes here\n  SetRuntimeVisibleHelper(true);\n  g.state.isTaskpaneOpen = true;\n  updateRibbon();\n  event.completed();\n}\n\nexport function btnCloseTaskpane(event: Office.AddinCommands.Event) {\n  console.log('Open task pane button pressed');\n  // Your code goes here\n  SetRuntimeVisibleHelper(false);\n  g.state.isTaskpaneOpen = false;\n  updateRibbon();\n  event.completed();\n}\n\nexport function btnEnableAddinStart(event: Office.AddinCommands.Event) {\n  console.log('Enable add-in start button pressed');\n  // Your code goes here\n  SetStartupBehaviorHelper(true);\n  g.state.isStartOnDocOpen = true;\n  updateRibbon();\n  event.completed();\n}\n\nexport function btnDisableAddinStart(event: Office.AddinCommands.Event) {\n  console.log('Disable add-in start button pressed');\n  // Your code goes here\n  SetStartupBehaviorHelper(false);\n  g.state.isStartOnDocOpen = false;\n  updateRibbon();\n\n  event.completed();\n}\n\nexport function btnInsertData(event: Office.AddinCommands.Event) {\n  console.log('Insert data button pressed');\n  // Mock code that pretends to insert data from a data source\n  insertData();\n  event.completed();\n}\n\nexport async function btnSumData(event: Office.AddinCommands.Event) {\n  console.log('Insert data button pressed');\n  // Mock code that pretends to insert data from a data source\n  let address = g.state.selectionAddress as string;\n  await Excel.run(context => {\n    let sheet = context.workbook.worksheets.getActiveWorksheet();\n    let range = sheet.getRange(address);\n    range.load('values');\n\n    let sum: number = 0;\n    return context.sync().then(() => {\n      range.values.forEach(v => {\n        let vnumber: number = +v.toString();\n        sum += vnumber;\n      });\n\n      return context.sync().then(() => {\n        let sheet = context.workbook.worksheets.getActiveWorksheet();\n\n        let range = sheet.getRange('F1');\n        range.values = [[sum]];\n        range.format.autofitColumns();\n        event.completed();\n        console.log(sum);\n        return context.sync();\n      });\n    });\n  });\n  event.completed();\n}\n\nasync function insertData() {\n  try {\n    await Excel.run(async context => {\n      let sheet = context.workbook.worksheets.getActiveWorksheet();\n      let expensesTable = sheet.tables.add('A1:D1', true /*hasHeaders*/);\n      expensesTable.name = 'ExpensesTable';\n\n      expensesTable.getHeaderRowRange().values = [\n        ['Date', 'Merchant', 'Category', 'Amount']\n      ];\n\n      expensesTable.rows.add(null /*add rows to the end of the table*/, [\n        ['1/1/2017', 'The Phone Company', 'Communications', '$120'],\n        ['1/2/2017', 'Northwind Electric Cars', 'Transportation', '$142'],\n        ['1/5/2017', 'Best For You Organics Company', 'Groceries', '$27'],\n        ['1/10/2017', 'Coho Vineyard', 'Restaurant', '$33'],\n        ['1/11/2017', 'Bellows College', 'Education', '$350'],\n        ['1/15/2017', 'Trey Research', 'Other', '$135'],\n        ['1/15/2017', 'Best For You Organics Company', 'Groceries', '$97']\n      ]);\n\n      if (Office.context.requirements.isSetSupported('ExcelApi', '1.2')) {\n        sheet.getUsedRange().format.autofitColumns();\n        sheet.getUsedRange().format.autofitRows();\n      }\n      context.sync().then(() => {\n        monitorSheetChanges();\n        return context.sync();\n      });\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n","import { getGlobal } from '../commands/commands';\n\n/**\n * Adds two numbers.\n * @customfunction\n * @param first First number\n * @param second Second number\n * @returns The sum of the two numbers.\n */\n/* global clearInterval, console, setInterval */\n\nexport function add(first: number, second: number): number {\n  return first + second;\n}\n\n/**\n * Returns data for a given category.\n * @customfunction\n * @param category The category to filter the data with\n * @returns {string[][]} A dynamic array with multiple results.\n */\nexport function getData(category: string): string[][] {\n  //Check that we are connected to service\n  const g = getGlobal() as any;\n\n  if (g.state.isConnected) {\n    if (category === 'Communications') {\n      return [['1/1/2017', 'The Phone Company', 'Communications', '$120']];\n    } else if (category === 'Transportation') {\n      return [\n        ['1/2/2017', 'Northwind Electric Cars', 'Transportation', '$142']\n      ];\n    } else if (category === 'Groceries') {\n      return [\n        ['1/5/2017', 'Best For You Organics Company', 'Groceries', '$27'],\n        ['1/15/2017', 'Best For You Organics Company', 'Groceries', '$97']\n      ];\n    } else {\n      return [\n        ['1/1/2017', 'The Phone Company', 'Communications', '$120'],\n        ['1/2/2017', 'Northwind Electric Cars', 'Transportation', '$142'],\n        ['1/5/2017', 'Best For You Organics Company', 'Groceries', '$27'],\n        ['1/10/2017', 'Coho Vineyard', 'Restaurant', '$33'],\n        ['1/11/2017', 'Bellows College', 'Education', '$350'],\n        ['1/15/2017', 'Trey Research', 'Other', '$135'],\n        ['1/15/2017', 'Best For You Organics Company', 'Groceries', '$97']\n      ];\n    }\n  } else {\n    // @ts-ignore\n    throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);\n  }\n}\n"],"sourceRoot":""}